<html>
<body>

<script type="text/javascript">

varTabList[] = [];

function switchTabs(tabWindowId, tabId){
        safari.extension.globalPage.contentWindow.console.log("Send to SwitchTabs");
        safari.extension.globalPage.contentWindow.switchTabs(tabWindowId, tabId);
        safari.self.hide();
        safari.extension.globalPage.contentWindow.console.log("Sent to SwitchTabs");
}



function createPopOver(){

    safari.extension.globalPage.contentWindow.console.log("CreatePopOver ");

    var myTabs = safari.extension.globalPage.contentWindow.getTabs();

    safari.extension.globalPage.contentWindow.console.log("Tablength: " + myTabs.length);

    document.write('<table id="grid"><tr>');

    for (var t = 0; t< myTabs.length; t++){
        document.write("<td> <a href=\"javascript:void(0)\" ");
        document.write("onClick=\"switchTabs(" +myTabs[t][0] + "," + myTabs[t][1]  + ");\">" + myTabs[t][2] +"</a>");
        document.write("</td></tr><tr>");
        }   
    
}    

safari.application.addEventListener("popover", createPopOver, true);



</script>



</body>
</html>
